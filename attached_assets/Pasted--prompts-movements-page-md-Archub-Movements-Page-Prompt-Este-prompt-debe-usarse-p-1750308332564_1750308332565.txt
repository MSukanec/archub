---
üìÅ prompts/movements-page.md
---

# üîÑ Archub ‚Äì Movements Page Prompt

Este prompt debe usarse para crear o mantener la p√°gina de **Movimientos** (`movements.tsx`) en el sistema Archub.
Debe seguir estrictamente los lineamientos visuales y t√©cnicos definidos en `prompts/ai-page-template.md`.

---

## üìÖ Prop√≥sito
La p√°gina `movements.tsx` permite visualizar, registrar y gestionar movimientos financieros dentro de un proyecto.

---

## üìù Comportamiento esperado

### 1. Estructura Visual
- Utilizar `CustomPageLayout`, `CustomPageHeader`, `CustomSearchButton`, `CustomTable`.
- Representar cada movimiento como una **fila** en una tabla completa (no usar cards).
- Mostrar filtros y b√∫squeda arriba.
- Bot√≥n de "Nuevo Movimiento" que abre un modal.

### 2. Campos visibles por movimiento (columnas):
- Fecha del movimiento (`created_at`)
- Descripci√≥n (`description`)
- Monto (`amount`)
- Tipo (`type_id` ‚Üí movement_concepts.name)
- Categor√≠a (`category_id` ‚Üí movement_concepts.name)
- Moneda (`currency_id` ‚Üí currencies.code)
- Billetera (`wallet_id` ‚Üí wallets.name)
- Creado por (`created_by` ‚Üí users.full_name + avatar)
- Acciones (Editar / Eliminar)

### 3. Modal de nuevo movimiento
- Compatible con desktop (anclado a la derecha) y mobile (100% alto).
- Componentes: `CustomModalLayout`, `CustomModalHeader`, `CustomModalBody`, `CustomModalFooter`
- Inputs necesarios:
  - Fecha del movimiento (editable)
  - Descripci√≥n (textarea)
  - Monto
  - Moneda (select desde `currencies`)
  - Tipo (select desde `movement_concepts` donde `parent_id IS NULL`)
  - Categor√≠a (select desde `movement_concepts` donde `parent_id = selected_type_id`)
  - Billetera (select desde `wallets` de la organizaci√≥n)
- Autom√°ticamente debe guardar:
  - `created_by` como `organization_members.id`
  - `organization_id`, `project_id` y `created_at` (editable)

### 4. L√≥gica de relaciones
- Usar la tabla `movement_concepts` como jer√°rquica:
  - Si `parent_id IS NULL` es tipo
  - Si `parent_id = uuid` es categor√≠a
- Evitar valores hardcodeados: todo se obtiene v√≠a Supabase.
- Filtrar movimientos por organizaci√≥n activa (`organization_id`) y proyecto activo (`project_id`).

---

## ‚õî Evitar
- No inventar campos.
- No usar valores de ejemplo.
- No usar textos hardcodeados.
- No traer datos directos con `supabase.from()`; usar `rpc` si aplica.

---

## ‚úÖ Resultado Esperado
Una p√°gina profesional, clara, 100% funcional, sin errores ni supuestos. Compatible con escritorio y mobile. Con el modal integrado para crear nuevos movimientos de manera intuitiva y ordenada.
